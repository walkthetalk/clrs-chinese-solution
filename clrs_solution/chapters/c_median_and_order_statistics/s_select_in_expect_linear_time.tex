\startsection[
  title={Selection in expected linear time},
  reference=section:selection_in_expected_linear_time,
]

\startEXERCISE
證明：在 \ALGO{RANDOMIZED-SELECT} 中，對長度爲 0 的數列，不會進行遞迴調用。
\stopEXERCISE

\startANSWER
要遞迴調用長度爲 0 的數列，則：
\startigNum
\startitem
第 8 行中，需要 \m{p=q}，即 \m{k=1}，但是 \m{i<k} 就不可能成立；
\stopitem
\startitem
第 9 行中，需要 \m{q=r}，則 \m{k=r-q+1}，但同時需要 \m{i>k}，不可能成立。
\stopitem
\stopigNum
然後根據歸納法維持不變式得證。
\stopANSWER

\startEXERCISE
討論：指示器隨機變量 \m{X_k} 和 \m{T(\max(k-1,n-k)} 是獨立的。
\stopEXERCISE

\startANSWER
劃分時選擇主元不影響子問題的概率。
即在 \ALGO{RANDOMIZED-PARTITION} 中調用 \ALGO{RANDOM} 所產生的結果與下一次迭代中調用他相互獨立。
\stopANSWER

\startEXERCISE
給出 \ALGO{RANDOMIZED-SELECT} 的一個基於循環的版本。
\stopEXERCISE

\startANSWER
\CLRSH{RANDOMIZED-SELECT-LOOP(A, p, r, i)}
\startCLRS
while p < r
	q = RANDOMIZED-PARTITION(A, p, r)
	k = q - p + 1
	if i == k
		return A[q]
	elseif i < k
		r = q - 1
	else
		p = q + 1
		i = i - k
return A[p]
\stopCLRS
\stopANSWER

\startEXERCISE
假設用 \ALGO{RANDOMIZED-SELECT} 去選擇數列 \m{A=\langle 3,2,9,0,7,5,4,8,6,1\rangle} 的最小元素，
給出能夠導致 \ALGO{RANDOMIZED-SELECT} 最壞情況發生的一個劃分序列。
\stopEXERCISE

\startANSWER
最壞情況意味着按反序選擇主元，即第一次選擇 9 爲主元，第二次選擇 8 爲主元，以此類推。
\stopANSWER

\stopsection
